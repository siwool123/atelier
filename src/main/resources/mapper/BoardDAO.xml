<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.edu.springboot.restboard.IBoardService">

	<select id="list" resultType="com.edu.springboot.restboard.BoardDTO" parameterType="com.edu.springboot.restboard.ParameterDTO">
		SELECT * FROM (
			SELECT Tb. *, rownum rNum FROM (
				SELECT * FROM board ORDER BY num DESC) Tb) WHERE rNum BETWEEN #{start} AND #{end}
	</select>
	
	<select id="search" resultType="com.edu.springboot.restboard.BoardDTO" parameterType="com.edu.springboot.restboard.ParameterDTO">
		SELECT * FROM board
		<if test="searchWord!=null">
			WHERE
			<foreach collection="searchWord" item="str" open="(" close=")" separator="or">
				${searchField} like '%'||#{str}||'%'
			</foreach>
		</if>
		ORDER BY num DESC
	</select>
	
	<select id="view" resultType="com.edu.springboot.restboard.BoardDTO" parameterType="com.edu.springboot.restboard.ParameterDTO">
		SELECT * FROM board WHERE num = #{num}
	</select>
	
	<insert id="write" >
		INSERT INTO board (num, title, content, id) VALUES (seq_notice.nextval, #{title}, #{content}, #{id})
	</insert>
</mapper> 